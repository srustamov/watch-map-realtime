(function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],u=0,d=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);m&&m(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var s=r[o];0!==n[s]&&(a=!1)}a&&(i.splice(t--,1),e=l(l.s=r[0]))}return e}var a={},o={app:0},n={app:0},i=[];function s(e){return l.p+"js/"+({}[e]||e)+"."+{"chunk-1e5258b1":"41f41068"}[e]+".js"}function l(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.e=function(e){var t=[],r={"chunk-1e5258b1":1};o[e]?t.push(o[e]):0!==o[e]&&r[e]&&t.push(o[e]=new Promise((function(t,r){for(var a="css/"+({}[e]||e)+"."+{"chunk-1e5258b1":"ba76a361"}[e]+".css",n=l.p+a,i=document.getElementsByTagName("link"),s=0;s<i.length;s++){var c=i[s],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===a||u===n))return t()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){c=d[s],u=c.getAttribute("data-href");if(u===a||u===n)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var a=t&&t.target&&t.target.src||n,i=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=a,delete o[e],m.parentNode.removeChild(m),r(i)},m.href=n;var f=document.getElementsByTagName("head")[0];f.appendChild(m)})).then((function(){o[e]=0})));var a=n[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,r){a=n[e]=[t,r]}));t.push(a[2]=i);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=s(e);var d=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(m);var r=n[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",d.name="ChunkLoadError",d.type=a,d.request=o,r[1](d)}n[e]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,r){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(r,a,function(t){return e[t]}.bind(null,a));return r},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var m=u;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var a=r("85ec"),o=r.n(a);o.a},1:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),o=r("8055"),n=r.n(o);window.$socket=n()(window.SOCKET_URL),a["a"].prototype.$socket=window.$socket;window.$socket,r("d3b7");var i=r("bc3a"),s=r.n(i),l={baseURL:window.API_URL||"http: //localhost:3333/api/"},c=s.a.create(l);c.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),c.interceptors.response.use((function(e){return e.data}),(function(e){return Promise.reject(e)})),Plugin.install=function(e,t){e.axios=c,window.axios=c,Object.defineProperties(e.prototype,{axios:{get:function(){return c}},$axios:{get:function(){return c}}})},a["a"].use(Plugin);Plugin;var u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-navigation-drawer",{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[r("navigator")],1),r("v-app-bar",{attrs:{app:""}},[r("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),r("v-spacer"),"home"==e.$route.name?r("v-btn",{attrs:{fab:"",color:e.$store.getters.create_area_dialog.show?"red":"success",small:""},on:{click:function(t){return e.$store.commit("createAreaDialogToggle")}}},[e.$store.getters.create_area_dialog.show?r("v-icon",{attrs:{color:"white"}},[e._v("mdi-close")]):r("v-icon",{attrs:{color:"white"}},[e._v("mdi-plus")])],1):e._e(),r("v-btn",{staticClass:"ml-3",attrs:{fab:"",small:""},on:{click:function(t){return e.changeTheme(!e.$vuetify.theme.dark)}}},[e.$vuetify.theme.dark?r("v-icon",{attrs:{color:"orange"}},[e._v("mdi-brightness-4")]):r("v-icon",{attrs:{color:"grey darken-1"}},[e._v("mdi-brightness-7")])],1)],1),r("v-main",{attrs:{app:""}},[r("router-view")],1)],1)},d=[],m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-list",{attrs:{nav:""}},[r("v-subheader",[e._v("Operation")]),r("v-list-item-group",{attrs:{color:"primary"},model:{value:e.nav,callback:function(t){e.nav=t},expression:"nav"}},[r("v-list-item",{class:{"v-item--active v-list-item--active":"home"==e.$route.name},on:{click:function(t){return e.$router.push({name:"home"})}}},[r("v-list-item-icon",[r("v-icon",{attrs:{color:"success"}},[e._v("mdi-map")])],1),r("v-list-item-content",[r("v-list-item-title",[e._v("create area")])],1)],1),r("v-list-item",{class:{"v-item--active v-list-item--active":"routes"==e.$route.name},on:{click:function(t){return e.$router.push({name:"routes"})}}},[r("v-list-item-icon",[r("v-icon",{attrs:{color:"success"}},[e._v("mdi-map")])],1),r("v-list-item-content",[r("v-list-item-title",[e._v("planning")])],1),r("v-list-item-avatar",[r("v-icon",{attrs:{color:"info"}},[e._v("mdi-drone")])],1)],1)],1),r("v-list-item",[r("v-list-item-content",[r("v-divider")],1)],1),r("v-list-item",[r("v-list-item-content",[r("v-select",{attrs:{items:e.layers,value:e.layer,"item-text":"name","item-value":function(e){return e},label:"select map type",outlined:""},on:{change:function(t){return e.$store.commit("selectLayer",t)}}})],1)],1)],1)},f=[],p=r("2f62"),v={data:function(){return{nav:""}},computed:Object(p["b"])(["layers","layer"])},h=v,g=r("2877"),b=r("6544"),y=r.n(b),_=r("ce7e"),w=r("132d"),x=r("8860"),k=r("da13"),A=r("8270"),M=r("5d23"),C=r("1baa"),$=r("34c3"),P=r("b974"),O=r("e0c7"),R=Object(g["a"])(h,m,f,!1,null,null,null),V=R.exports;y()(R,{VDivider:_["a"],VIcon:w["a"],VList:x["a"],VListItem:k["a"],VListItemAvatar:A["a"],VListItemContent:M["a"],VListItemGroup:C["a"],VListItemIcon:$["a"],VListItemTitle:M["b"],VSelect:P["a"],VSubheader:O["a"]});var I={components:{navigator:V},data:function(){return{drawer:!1,title:"Geo-location"}},methods:{changeTheme:function(e){this.$vuetify.theme.dark=e,localStorage.setItem("theme",e)}},mounted:function(){var e=localStorage.getItem("theme");this.$vuetify.theme.dark=!e||"true"===e}},S=I,j=(r("034f"),r("7496")),E=r("40dc"),T=r("5bc1"),N=r("8336"),z=r("f6c4"),D=r("f774"),q=r("2fa4"),B=Object(g["a"])(S,u,d,!1,null,null,null),F=B.exports;y()(B,{VApp:j["a"],VAppBar:E["a"],VAppBarNavIcon:T["a"],VBtn:N["a"],VIcon:w["a"],VMain:z["a"],VNavigationDrawer:D["a"],VSpacer:q["a"]});var G=r("8c4f"),W=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.loading?r("div",{staticClass:"pa-9 d-flex flex-column justify-center align-center",staticStyle:{height:"100%"}},[r("v-progress-circular",{attrs:{size:70,width:7,color:"purple",indeterminate:""}}),r("p",[e._v("loading...")])],1):r("div",[r("map-component",{ref:"map",attrs:{zoom:e.map.zoom,center:e.map.center},on:{select:e.clickMapArea}}),e.create_area_dialog.show?r("v-card",{staticClass:"input_area_dialog_card",style:"width:"+e.create_area_dialog.width,attrs:{tile:""}},[r("v-toolbar",{attrs:{dense:""}},[r("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$store.commit("createAreaDialogSizeToggle")}}},["auto"===e.create_area_dialog.width?r("v-icon",{attrs:{color:"orange"}},[e._v("mdi-window-minimize")]):r("v-icon",{attrs:{color:"orange"}},[e._v("mdi-application")])],1),r("v-spacer"),r("v-btn",{attrs:{icon:""},on:{click:function(t){return e.$store.commit("createAreaDialogToggle")}}},[r("v-icon",{attrs:{color:"red"}},[e._v("mdi-close")])],1)],1),r("div",{staticClass:"pa-4",style:"50px"===e.create_area_dialog.width?"visibility:hidden":""},[r("area-forms",{attrs:{map:e.$refs.map,selectedMapArea:e.selectedMapArea},on:{close:function(t){return e.$store.commit("createAreaDialogToggle")},"reset-map-area":function(t){e.selectedMapArea=null}}})],1)],1):e._e()],1)},U=[],Y=(r("d81d"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{attrs:{id:"map"}}),r("v-row",{attrs:{justify:"center"}},[r("v-dialog",{ref:"remove_layer",attrs:{"max-width":"500",persistent:""},model:{value:e.remove_layer_dialog,callback:function(t){e.remove_layer_dialog=t},expression:"remove_layer_dialog"}},[r("v-card",{attrs:{tile:""}},[r("v-card-title",[e._v("remove layer?")]),r("v-card-actions",{staticClass:"d-flex justify-space-between"},[r("v-btn",{on:{click:function(t){e.remove_layer_dialog=!1}}},[e._v("cancel")]),r("v-btn",{attrs:{color:"red"},on:{click:function(t){return e.removeLayer(e.remove_layer_id)}}},[e._v("remove")])],1)],1)],1)],1)],1)}),J=[],H=(r("99af"),r("7db0"),r("c740"),r("a434"),r("b0c0"),r("07ac"),r("2909")),K=(r("4160"),r("159b"),r("d4ec")),Q=r("ade3"),X=Math.PI,Z=2*Math.PI,ee=6378.1,te=function(e,t,r,a){var o=a*Math.PI/180,n=e*Math.PI/180,i=t*Math.PI/180,s=r/1e3;return n=Math.asin(Math.sin(n)*Math.cos(s/ee)+Math.cos(n)*Math.sin(s/ee)*Math.cos(o)),i+=Math.atan2(Math.sin(o)*Math.sin(s/ee)*Math.cos(n),Math.cos(s/ee)-Math.sin(n)*Math.sin(n)),{lat:180*n/Math.PI,lng:180*i/Math.PI}};function re(e,t,r,a){var o=r*Math.PI/180-e*Math.PI/180,n=a*Math.PI/180-t*Math.PI/180,i=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2),s=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),l=ee*s;return 1e3*l}var ae=function e(){Object(K["a"])(this,e)};Object(Q["a"])(ae,"isInsidePitch",(function(e,t,r){var a=[],o=[];r.forEach((function(e){a.push(e[0]),o.push(e[1])}));for(var n,i,s,l,c=0,u=a.length,d=0;d<u;d++)n=a[d]-e,i=o[d]-t,s=a[(d+1)%u]-e,l=o[(d+1)%u]-t,c+=ae.angle2D(n,i,s,l);return!(Math.abs(c)<X)})),Object(Q["a"])(ae,"isInsideCircle",(function(e,t,r,a){return re(e,t,r.lat,r.lng)<=a})),Object(Q["a"])(ae,"angle2D",(function(e,t,r,a){var o,n,i;n=Math.atan2(e,t),i=Math.atan2(r,a),o=i-n;while(o>X)o-=Z;while(o<-X)o+=Z;return o})),Object(Q["a"])(ae,"isValidCoordinate",(function(e,t){return""!==e&&""!==t&&!isNaN(e)&&!isNaN(t)&&e>-90&&e<90&&t>-180&&t<180}));var oe=function(){return new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t):t()}))},ne=function(e){if("Notification"in window)if("granted"===Notification.permission)new Notification(e);else"denied"!==Notification.permission&&Notification.requestPermission().then((function(t){if("granted"===t)new Notification(e)}));else alert("This browser does not support desktop notification")},ie=r("5b69"),se={props:["center","zoom"],data:function(){return{map:null,markers:[],layers:[],remove_layer_dialog:!1,remove_layer_id:null,safe_areas:[{id:Date.now(),name:"Airport",type:"polygon",polygon:[[40.465243,50.050168],[40.466957,50.052108],[40.466812,50.053873],[40.464944,50.054311],[40.465243,50.050168]]}]}},mounted:function(){var e=this;L.Corridor=L.Polyline.extend(ie["a"]),L.corridor=function(e,t){return new L.Corridor(e,t||{corridor:100})},this.map=L.map("map").setView(this.center,this.zoom),this.map.on("click",(function(t){e.$emit("select",t)})),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; ASC"}).addTo(this.map),$socket.on("location",(function(t){if(t.socket_id){for(var r=!1,a=0;a<e.safe_areas.length;a++){var o=e.safe_areas[a];if("polygon"===o.type?r=ae.isInsidePitch(t.latitude,t.longitude,o.polygon):"center"===o.type&&(r=ae.isInsideCircle(t.latitude,t.longitude,o.center,o.radius)),r){r=o.name||"danger zone";break}}r&&($socket.emit("safe-area",{id:t.socket_id,name:r}),ne("Safe Area")),e.createOrUpdateMarker(t)}})),$socket.on("leave",this.clearMarker)},methods:{createRectangle:function(e,t){L.rectangle([e,t],{color:"Red",weight:1}).addTo(this.map),ne("Created area")},createPolygon:function(e){var t=this,r=Date.now(),a=L.polygon(e,{color:"#ff7800",weight:3,id:r}).on("contextmenu",(function(e){t.remove_layer_id=e.target.options.id,t.remove_layer_id&&(t.remove_layer_dialog=!0)})).addTo(this.map);a.id=r,this.layers.push(a),this.safe_areas.push({id:r,name:"safe area",polygon:e,type:"polygon"}),ne("Created area")},createCircle:function(e,t){var r=this,a=Date.now(),o=L.circle(e,parseFloat(t),{color:"red",fillColor:"#ab5c5c80",fillOpacity:5,id:a}).on("contextmenu",(function(e){r.remove_layer_id=e.target.options.id,r.remove_layer_id&&(r.remove_layer_dialog=!0)})).addTo(this.map);o.id=a,this.layers.push(o),this.safe_areas.push({id:a,name:"safe area",center:e,radius:t,type:"circle"}),ne("Created area")},createLine:function(e){var t,r,a=this,o=Date.now();2===e.type&&(e.coords.end=te.apply(void 0,Object(H["a"])(Object.values(e.coords.start)).concat([e.distance,e.bearing])));var n=L.corridor([(t=L).latLng.apply(t,Object(H["a"])(Object.values(e.coords.start))),(r=L).latLng.apply(r,Object(H["a"])(Object.values(e.coords.end)))],{id:o,corridor:e.width,className:"route-corridor"}).on("contextmenu",(function(e){a.remove_layer_id=e.target.options.id,a.remove_layer_id&&(a.remove_layer_dialog=!0)}));n.id=o,this.map.fitBounds(n.getBounds()),this.map.addLayer(n),this.layers.push(n),this.safe_areas.push({id:o,name:e.name||"Route line",type:"line",data:e})},removeLayer:function(e){var t=this.layers.findIndex((function(t){return t.id===e}));t>-1&&(this.map.removeLayer(this.layers[t]),this.layers.splice(t,1)),this.remove_layer_dialog=!1,this.remove_layer_id=null,t=this.safe_areas.findIndex((function(t){return t.id===e})),t>-1&&this.safe_areas.splice(t,1)},getCoordsFromData:function(e){var t=e.latitude,r=e.longitude;return[t,r].map((function(e){return parseFloat(e)}))},createOrUpdateMarker:function(e){var t="\n        imei:     ".concat(e.imei," <br/>\n        serial:   ").concat(e.serial," <br/>\n        latitude: ").concat(e.latitude," <br/>\n        longitude: ").concat(e.longitude," <br/>\n        altitude: ").concat(e.altitude," <br/>\n      "),r=this.markers.find((function(t){return t._id===e.socket_id}));if(r)r.setLatLng(this.getCoordsFromData(e)).update(),r.setPopupContent(t);else{var a=L.marker(this.getCoordsFromData(e)).addTo(this.map).bindPopup(t);a._id=e.socket_id,this.markers.push(a)}},clearMarker:function(e){var t=this.markers.findIndex((function(t){return t._id===e}));t>-1&&(this.map.removeLayer(this.markers[t]),this.markers.splice(t,1))},addDecorator:function(e){L.polylineDecorator(e,{patterns:[{offset:0,repeat:10,symbol:L.Symbol.dash({pixelSize:1})}]}).addTo(this.map)}}},le=se,ce=(r("db99"),r("b0af")),ue=r("99d9"),de=r("169a"),me=r("0fd9"),fe=Object(g["a"])(le,Y,J,!1,null,"590a0f45",null),pe=fe.exports;y()(fe,{VBtn:N["a"],VCard:ce["a"],VCardActions:ue["a"],VCardTitle:ue["b"],VDialog:de["a"],VRow:me["a"]});var ve=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.form.valid,callback:function(t){e.$set(e.form,"valid",t)},expression:"form.valid"}},[r("v-select",{attrs:{"item-text":"name","item-value":"id",items:e.areas,rules:[function(e){return!!e||"Area Type is required"}],label:"Area type",required:""},model:{value:e.form.area,callback:function(t){e.$set(e.form,"area",t)},expression:"form.area"}}),e.form.area===e.CIRCLE_AREA?r("div",[r("circle-form",{attrs:{selectedMapArea:e.selectedMapArea},on:{draw:e.drawCircleArea}})],1):e._e(),e.form.area===e.POLYGON_AREA?r("div",[r("polygon-form",{attrs:{selectedMapArea:e.selectedMapArea},on:{draw:e.drawPolygon}})],1):e._e(),e.form.area===e.LIEN_AREA?r("div",[r("line-form",{attrs:{selectedMapArea:e.selectedMapArea},on:{draw:e.drawNavLine}})],1):e._e(),e.form.area===e.RECTANGLE_AREA?r("div",[r("rectangle-form",{attrs:{selectedMapArea:e.selectedMapArea},on:{draw:e.drawRectangleArea}})],1):e._e(),r("v-btn",{staticClass:"mr-4",attrs:{color:"error"},on:{click:function(t){return e.$refs.form.reset()}}},[e._v("Reset information")])],1)},he=[],ge=(r("498a"),1),be=2,ye=3,_e=4,we=1,xe=2,Le={lat:[function(e){return""!==String(e).trim()||"Latitude is required"},function(e){return e<=90&&e>=-90||"Latitude invalid"}],lng:[function(e){return""!==String(e).trim()||"Longitude is required"},function(e){return e<=180&&e>=-180||"Longitude invalid"}]},ke=[{id:ge,name:"circle"},{id:be,name:"navigation line"},{id:ye,name:"rectangle"},{id:_e,name:"polygon"}],Ae={rules:{width:[function(e){return""!==String(e).trim()||"Width is required"},function(e){return e>2||"Width invalid"}],bearing:[function(e){return""!==String(e).trim()||"Bearing is required"},function(e){return e>=-360&&e<=360||"Bearing invalid"}],distance:[function(e){return""!==String(e).trim()||"Distance is required"},function(e){return parseFloat(e)>0||"Distance invalid"}]},types:[{number:we,name:"Cartesian coordinate system"},{number:xe,name:"Polar coordinate system"}],type:we,coords:{start:{lat:"",lng:""},end:{lat:"",lng:""}},width:2,bearing:"",distance:""},Me={inputs:[{lat:"",lng:""},{lat:"",lng:""},{lat:"",lng:""}]},Ce={coords:{lat:"",lng:""},radius:"",rules:{radius:[function(e){return""!==String(e).trim()||"Radius is required"},function(e){return e>1||"Radius invalid"}]}},$e={coords:[{lat:"",lng:""},{lat:"",lng:""}]},Pe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",{staticClass:"text-center d-flex align-center justify-space-between",attrs:{cols:"12"}},[e._v(" Center Coordinates "),r("v-btn",{attrs:{loading:e.currentLocationLoading,title:"get current location",fab:""},on:{click:e.getCurrentCoords}},[r("v-icon",{attrs:{color:"success"}},[e._v("mdi-crosshairs-gps")])],1)],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{label:"Latitude",type:"number",rules:e.coordinatesRules.lat},model:{value:e.form.coords.lat,callback:function(t){e.$set(e.form.coords,"lat",t)},expression:"form.coords.lat"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{type:"number",label:"Longitude",rules:e.coordinatesRules.lng},model:{value:e.form.coords.lng,callback:function(t){e.$set(e.form.coords,"lng",t)},expression:"form.coords.lng"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{type:"number",rules:[function(e){return""!==String(e).trim()||"Radius is required"},function(e){return e>1||"Radius invalid"}],label:"Radius",suffix:"meter"},model:{value:e.form.radius,callback:function(t){e.$set(e.form,"radius",t)},expression:"form.radius"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("draw",e.form)}}},[e._v("draw")])],1)],1)},Oe=[],Re=(r("b64b"),r("53ca")),Ve=function(e){return JSON.parse(JSON.stringify(e))},Ie=function(e){return Array.isArray(e)?0===e.length:"object"===Object(Re["a"])(e)?0===Object.keys(e).length:"string"===typeof e&&""===e.trim()},Se={props:["selectedMapArea"],data:function(){return{form:Ve(Ce),coordinatesRules:Le,currentLocationLoading:!1}},methods:{getCurrentCoords:function(){var e=this;this.currentLocationLoading=!0,oe().then((function(t){e.$set(e.form,"coords",{lat:t.coords.latitude,lng:t.coords.longitude}),e.currentLocationLoading=!1})).catch((function(){e.currentLocationLoading=!1}))}},watch:{selectedMapArea:function(e){e&&this.$set(this.form,"coords",e)}}},je=Se,Ee=r("62ad"),Te=r("8654"),Ne=Object(g["a"])(je,Pe,Oe,!1,null,null,null),ze=Ne.exports;y()(Ne,{VBtn:N["a"],VCol:Ee["a"],VIcon:w["a"],VRow:me["a"],VTextField:Te["a"]});var De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-select",{attrs:{"item-text":"name","item-value":"number",items:e.form.types,rules:[function(e){return!!e||"type is required"}],label:"coordinate system type",required:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}),r("v-row",[r("v-col",{staticClass:"text-center d-flex align-center justify-space-between",attrs:{cols:"12"}},[e._v(" Start Position "),r("v-btn",{attrs:{loading:e.currentLocationLoading,title:"get current location",fab:""},on:{click:e.getCurrentCoords}},[r("v-icon",{attrs:{color:"success"}},[e._v("mdi-crosshairs-gps")])],1)],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{label:"Latitude",type:"number",rules:e.coordinatesRules.lat},model:{value:e.form.coords.start.lat,callback:function(t){e.$set(e.form.coords.start,"lat",t)},expression:"form.coords.start.lat"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{type:"number",label:"Longitude",rules:e.coordinatesRules.lng},model:{value:e.form.coords.start.lng,callback:function(t){e.$set(e.form.coords.start,"lng",t)},expression:"form.coords.start.lng"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{type:"number",label:"Line corridor width",rules:[function(e){return""!==String(e).trim()||"Width is required"},function(e){return e>=2||"Width invalid"}],suffix:"meter",required:""},model:{value:e.form.width,callback:function(t){e.$set(e.form,"width",t)},expression:"form.width"}})],1)],1),e.form.type===e.LINE_AREA_SYSTEM_CARTESIAN?r("v-row",[r("v-col",{staticClass:"text-center d-flex align-center justify-space-between",attrs:{cols:"12"}},[e._v("End Position")]),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{label:"Latitude",type:"number",rules:e.form.rules.lat},model:{value:e.form.coords.end.lat,callback:function(t){e.$set(e.form.coords.end,"lat",t)},expression:"form.coords.end.lat"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{type:"number",label:"Longitude",rules:e.form.rules.lng},model:{value:e.form.coords.end.lng,callback:function(t){e.$set(e.form.coords.end,"lng",t)},expression:"form.coords.end.lng"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("draw",e.form)}}},[e._v("draw")])],1)],1):e._e(),e.form.type===e.LINE_AREA_SYSTEM_POLAR?r("v-row",[r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{type:"number",label:"Angle from the north",rules:[function(e){return""!==String(e).trim()||"angle is required"},function(e){return e>=-360&&e<=360||"angle invalid"}],"append-icon":"mdi-angle-acute",example:"30",required:""},model:{value:e.form.bearing,callback:function(t){e.$set(e.form,"bearing",t)},expression:"form.bearing"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{outlined:"",type:"number",label:"Distance",rules:[function(e){return""!==String(e).trim()||"distance is required"},function(e){return parseFloat(e)>0||"distance invalid"}],suffix:"meter",hint:"example 500",required:""},model:{value:e.form.distance,callback:function(t){e.$set(e.form,"distance",t)},expression:"form.distance"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("draw",e.form)}}},[e._v("draw")])],1)],1):e._e()],1)},qe=[],Be={props:["selectedMapArea"],data:function(){return{currentLocationLoading:!1,form:Ve(Ae),coordinatesRules:Le,LINE_AREA_SYSTEM_CARTESIAN:we,LINE_AREA_SYSTEM_POLAR:xe}},methods:{getCurrentCoords:function(){var e=this;this.currentLocationLoading=!0,oe().then((function(t){e.setCoords({lat:t.coords.latitude,lng:t.coords.longitude}),e.currentLocationLoading=!1})).catch((function(){e.currentLocationLoading=!1}))},setCoords:function(e){this.form.type===we?Ie(this.form.coords.start.lat)?this.$set(this.form.coords,"start",e):Ie(this.form.coords.end.lat)?this.$set(this.form.coords,"end",e):this.form.coords=Ve(Ae).coords:this.form.type===xe&&this.$set(this.form.coords,"start",e)}},watch:{selectedMapArea:function(e){e&&this.setCoords(e)}}},Fe=Be,Ge=Object(g["a"])(Fe,De,qe,!1,null,null,null),We=Ge.exports;y()(Ge,{VBtn:N["a"],VCol:Ee["a"],VIcon:w["a"],VRow:me["a"],VSelect:P["a"],VTextField:Te["a"]});var Ue=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._l(e.form.inputs,(function(t,a){return r("v-row",{key:a},[r("v-col",{staticClass:"d-flex align-center",attrs:{cols:"12",sm:"12",md:"5"}},[r("v-text-field",{attrs:{outlined:"",type:"number",label:"Latitude",rules:e.coordinatesRules.lat},model:{value:e.form.inputs[a].lat,callback:function(t){e.$set(e.form.inputs[a],"lat",t)},expression:"form.inputs[key].lat"}})],1),r("v-col",{staticClass:"d-flex align-center",attrs:{cols:"12",sm:"12",md:"5"}},[r("v-text-field",{attrs:{outlined:"",type:"number",label:"Longitude",rules:e.coordinatesRules.lng},model:{value:e.form.inputs[a].lng,callback:function(t){e.$set(e.form.inputs[a],"lng",t)},expression:"form.inputs[key].lng"}})],1),a>2?r("v-col",{staticClass:"d-flex align-start",attrs:{cols:"12",sm:"12",md:"2"}},[r("v-btn",{attrs:{"x-small":"",fab:""},on:{click:function(t){return e.removeInput(a)}}},[r("v-icon",{attrs:{color:"red"}},[e._v("mdi-close")])],1)],1):e._e()],1)})),r("div",{staticClass:"d-flex justify-space-between align-center my-2"},[r("v-btn",{attrs:{color:"info"},on:{click:e.addInput}},[e._v(" add "),r("v-icon",[e._v("mdi-plus")])],1),r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("draw",e.form)}}},[e._v("draw")])],1)],2)},Ye=[],Je={props:["selectedMapArea"],data:function(){return{form:Ve(Me),coordinatesRules:Le}},methods:{addInput:function(){this.form.inputs.push({lat:"",lng:""})},removeInput:function(e){this.form.inputs.length>3&&this.form.inputs.splice(e,1)}},watch:{selectedMapArea:function(e){if(e){for(var t=this.form.inputs.length,r=0;r<t;r++){var a=this.form.inputs[r];if(Ie(a.lat))return this.$set(this.form.inputs,r,e)}this.form=Ve(Me),this.$set(this.form.inputs,0,e)}}}},He=Je,Ke=Object(g["a"])(He,Ue,Ye,!1,null,null,null),Qe=Ke.exports;y()(Ke,{VBtn:N["a"],VCol:Ee["a"],VIcon:w["a"],VRow:me["a"],VTextField:Te["a"]});var Xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",[r("v-col",{staticClass:"text-center d-flex align-center justify-center",attrs:{cols:"12"}},[e._v("Positions")]),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{label:"Latitude",type:"number",rules:e.coordinatesRules.lat},model:{value:e.form.coords[0].lat,callback:function(t){e.$set(e.form.coords[0],"lat",t)},expression:"form.coords[0].lat"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{type:"number",label:"Longitude",rules:e.coordinatesRules.lng},model:{value:e.form.coords[0].lng,callback:function(t){e.$set(e.form.coords[0],"lng",t)},expression:"form.coords[0].lng"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{label:"Latitude",type:"number",rules:e.coordinatesRules.lat},model:{value:e.form.coords[1].lat,callback:function(t){e.$set(e.form.coords[1],"lat",t)},expression:"form.coords[1].lat"}})],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"6"}},[r("v-text-field",{attrs:{type:"number",label:"Longitude",rules:e.coordinatesRules.lng},model:{value:e.form.coords[1].lng,callback:function(t){e.$set(e.form.coords[1],"lng",t)},expression:"form.coords[1].lng"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("draw",e.form)}}},[e._v("draw")])],1)],1)},Ze=[],et={props:["selectedMapArea"],data:function(){return{form:Ve($e),coordinatesRules:Le}},watch:{selectedMapArea:function(e){e&&(Ie(this.form.coords[0].lat)?this.$set(this.form.coords,0,e):Ie(this.form.coords[1].lat)?this.$set(this.form.coords,1,e):this.form=Ve($e))}}},tt=et,rt=Object(g["a"])(tt,Xe,Ze,!1,null,null,null),at=rt.exports;y()(rt,{VBtn:N["a"],VCol:Ee["a"],VRow:me["a"],VTextField:Te["a"]});var ot={props:["map","selectedMapArea"],components:{"circle-form":ze,"line-form":We,"polygon-form":Qe,"rectangle-form":at},data:function(){return{CIRCLE_AREA:ge,LIEN_AREA:be,RECTANGLE_AREA:ye,POLYGON_AREA:_e,areas:ke,form:{valid:!0,area:null}}},methods:{drawPolygon:function(e){this.$refs.form.validate()&&(this.map.createPolygon(e.inputs.map((function(e){return Object.values(e)}))),this.form.area="",this.resetAndClose())},drawCircleArea:function(e){this.$refs.form.validate()&&(this.map.createCircle(Object.values(e.coords),e.radius),this.form.area="",this.resetAndClose())},drawRectangleArea:function(e){this.$refs.form.validate()&&(this.map.createRectangle(Object.values(e.coords[0]),Object.values(e.coords[1])),this.form.area="",this.resetAndClose())},drawNavLine:function(e){this.$refs.form.validate()&&(this.map.createLine(e),this.resetAndClose())},resetAndClose:function(){this.$emit("reset-map-area"),this.$emit("close")}},watch:{area:function(){this.$emit("reset-map-area")}}},nt=ot,it=r("4bd4"),st=Object(g["a"])(nt,ve,he,!1,null,null,null),lt=st.exports;y()(st,{VBtn:N["a"],VForm:it["a"],VSelect:P["a"]});var ct={components:{MapComponent:pe,AreaForms:lt},data:function(){return{loading:!0,selectedMapArea:null,map:{center:[40.462964,50.052201],zoom:10}}},mounted:function(){var e=this;this.$axios.get("/map/configs").then((function(t){return e.map=t})).finally((function(){return e.loading=!1}))},computed:Object(p["b"])(["create_area_dialog"]),methods:{clickMapArea:function(e){this.selectedMapArea=e.latlng}}},ut=ct,dt=(r("b3a3"),r("490a")),mt=r("71d9"),ft=Object(g["a"])(ut,W,U,!1,null,"1840eb41",null),pt=ft.exports;y()(ft,{VBtn:N["a"],VCard:ce["a"],VIcon:w["a"],VProgressCircular:dt["a"],VSpacer:q["a"],VToolbar:mt["a"]}),a["a"].use(G["a"]);var vt=[{path:"/",name:"home",component:pt},{path:"/routes",name:"routes",component:function(){return r.e("chunk-1e5258b1").then(r.bind(null,"dffb"))}}],ht=new G["a"]({mode:"history",base:"/",routes:vt}),gt=ht;a["a"].use(p["a"]);var bt=new p["a"].Store({state:{create_area_dialog:{show:!1,minimize:!1,width:"auto"},layers:[{base:!0,name:"Open Street Map",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"Google Map Streets",url:"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"},{name:"Google Map Hybrid",url:"http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}"},{name:"Google Map Satellite",url:"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}"},{name:"Google Map Terrain",url:"http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}"}],layer:{base:!0,name:"Open Street Map",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}},getters:{create_area_dialog:function(e){return e.create_area_dialog},layers:function(e){return e.layers},layer:function(e){return e.layer}},mutations:{createAreaDialogSizeToggle:function(e){e.create_area_dialog.width="auto"===e.create_area_dialog.width?"50px":"auto"},createAreaDialogToggle:function(e){e.create_area_dialog.show=!e.create_area_dialog.show},createAreaDialogWidth:function(e,t){e.create_area_dialog.width=t},createAreaDialogMin:function(e,t){e.create_area_dialog.minimize=t},selectLayer:function(e,t){e.layer=t}},actions:{},modules:{}}),yt=r("f309"),_t=r("c0a4"),wt=r.n(_t);a["a"].use(yt["a"]);var xt=new yt["a"]({theme:{dark:!0,themes:{dark:{primary:wt.a.blue.darken2,accent:wt.a.grey.darken3,secondary:wt.a.amber.darken3,info:wt.a.teal.lighten1,warning:wt.a.amber.base,error:wt.a.deepOrange.accent4,success:wt.a.green.accent3}}}});Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI},a["a"].config.productionTip=!1,new a["a"]({router:gt,store:bt,vuetify:xt,render:function(e){return e(F)}}).$mount("#app")},"5b69":function(e,t,r){"use strict";t["a"]={initialize:function(e,t){var r=this;L.Polyline.prototype.initialize.call(this,e,t),this.corridor=t.corridor,this.updateCallback=function(e){r._updateWeight(this)}},onAdd:function(e){L.Polyline.prototype.onAdd.call(this,e),e.on("zoomend",this.updateCallback),this._updateWeight(e)},onRemove:function(e){e.off("zoomend",this.updateCallback),L.Polyline.prototype.onRemove.call(this,e)},_updateWeight:function(e){this.setStyle({weight:this._getWeight(e,this.corridor)})},_getWeight:function(e,t){return 2*t/this._getMetersPerPixel(e)},_getMetersPerPixel:function(e){var t=e.getCenter(),r=e.latLngToContainerPoint(t),a=L.point(r.x+10,r.y),o=e.containerPointToLatLng(a);return t.distanceTo(o)/10}}},"85ec":function(e,t,r){},"9c0d":function(e,t,r){},b29e:function(e,t,r){},b3a3:function(e,t,r){"use strict";var a=r("b29e"),o=r.n(a);o.a},db99:function(e,t,r){"use strict";var a=r("9c0d"),o=r.n(a);o.a}});
//# sourceMappingURL=app.803b5d79.js.map